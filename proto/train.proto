syntax = "proto3";

package train;

service Trainer {
    rpc RunStep(RunStepReuest) returns (RunStepResponse) {}
}

message RunStepReuest {
    int32 epoch = 1;
    int32 step = 2;
    bytes data = 3;
}

message RunStepResponse {
    int32 epoch = 1;
    int32 step = 2;
    bytes grads = 3;
    bytes loss = 4;
}

// Command to generate pb files.
// python -m grpc_tools.protoc -Iproto --python_out=. --pyi_out=. --grpc_python_out=.  proto/train.proto